---
layout: post
title: IoT with Database low-fi model
category: RaspberryPi
---

![A collage of David's temperature experiment](/images/20200613_105148-COLLAGE.jpg)
From the left Clockwise - Presence triggered camera, Environmental sensor, the RaspberryPi 4 with mSata and the self built Linux computer

### IoT with Database using a low-fi model approach
In this article I provide some illustration of my work in moving Sensors from Raspberry Pi 3B to Raspberry Pi 4 and testing
the set-up using the quickest approach to storing readings.  Using a Postgres database over on AWS.  As a little extra spice I used an Anker Power Bank to power the sensor array and Edge Device. In order to run this experiment you would need:-

1. An edge device ( Raspberry Pi 4 for me );
2. A sensor(s) ( Sense Hat for me );
3. A program, flow or script to take the readings from the sensor and relay those to the database ( Python for me );
4. A Database ( AWS RDS - Postgres for me);
5. Database management software ( DBeaver for me);
6. Visualiation software to view the results ( Jupyter Notebook,  and Python for me );
7. A host machine to run the dashboard ( local host for me )

Let us look at each topic in turn and then look at the results of the experiment.

#### An edge device
Sensors are very basic pieces of equipment and need to be read by an Edge device in order to get a measurement. An Edge device serves as a bridge between the Sensor(s) and the real world.  The Edge device could be monitoring many sensors and collecting or aggregrating the data before transmittal.  For this experiment I am using a Raspberry Pi 4 ( 2 GIG ram ) with onboard Sense Hat.  The device boots from USB stick and has onboard WiFi connected by 5G signal to the Fiber network (Eir Ireland). Therefore the device has high speed access to the boader internet and maintains a constant connection with the AWS RDS environment. An Anker battery is supply power and therefore the experiment mimics real world finite power conditions.

[More about the Raspberry Pi here](https://www.raspberrypi.org/).  I use Raspberry Pi because of the GIPO and the Software available which makes doing these experiments really easy.

#### Sensors
![Sensors](/images/sense_hat_sen.png)

[image and more information](https://medium.com/@raunakgupta.ece2013/awsiot-with-raspberry-pi-using-paho-mqtt-fa4ee50192fb)
We can see from the small image that the Sense Hat as quite a few onboard sensors and that makes it ideal for this experiment. However the configuration of adding the Sense Hat directly to the Raspberry Pi will not work in practice.  The Raspberry Pi board generates heat and that heat is soaked up by the Sense Hat skewing any readings from the sensors.

To fix the heat problem and get accurate readings is not easy.  The boards need to be detached and kept apart.
![Boards kept apart](/images/apart.JPG)

The image shows that I built a small cluster and connected the two boards with a 40-Pin male to female connection. With the test system built you would also need the software library.  I used Python and here is the library [Python library for Sense Hat](https://pythonhosted.org/sense-hat/).  Some embedded systems, like Arduino,  use C and you need the C libraries for given sensors.


#### Control logic, scripts, programs,  flows
While you can get either a Python or C library for each sensor or sensor set, you still need to write some code to wrap the library and handle transmission. My [earlier post](https://cognitivedave.github.io/IoT/) described the basics of working with the Sense hat.

#### A database

#### DBeaver

#### Visuals

#### Hosting the dashboard

### Conclusion
